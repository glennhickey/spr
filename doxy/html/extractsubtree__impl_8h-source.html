<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>SPR: extractsubtree_impl.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<div class="nav">
<a class="el" href="dir_000000.html">src</a></div>
<h1>extractsubtree_impl.h</h1><a href="extractsubtree__impl_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="preprocessor">#include &lt;sstream&gt;</span>
00002 <span class="preprocessor">#include &lt;algorithm&gt;</span>
00003 <span class="preprocessor">#include &lt;sstream&gt;</span>
00004 
00005 <span class="keyword">template</span>&lt;<span class="keyword">class</span> T, <span class="keyword">class</span> U&gt;
<a name="l00006"></a><a class="code" href="classExtractSubtree.html#a0">00006</a> <a class="code" href="classExtractSubtree.html#a0">ExtractSubtree&lt;T, U&gt;::ExtractSubtree</a>() 
00007 {
00008 
00009 }
00010 
00011 <span class="keyword">template</span>&lt;<span class="keyword">class</span> T, <span class="keyword">class</span> U&gt;
<a name="l00012"></a><a class="code" href="classExtractSubtree.html#a1">00012</a> <a class="code" href="classExtractSubtree.html#a1">ExtractSubtree&lt;T, U&gt;::~ExtractSubtree</a>() 
00013 {
00014 
00015 }
00016 
00031 <span class="keyword">template</span>&lt;<span class="keyword">class</span> T, <span class="keyword">class</span> U&gt;
<a name="l00032"></a><a class="code" href="classExtractSubtree.html#a2">00032</a> <span class="keywordtype">bool</span> <a class="code" href="classExtractSubtree.html#a2">ExtractSubtree&lt;T, U&gt;::extract</a>(<span class="keyword">const</span> <a class="code" href="structUPTree.html">UPTree&lt;U&gt;</a>&amp; superTree, 
00033                              <span class="keyword">const</span> std::vector&lt;std::string&gt;&amp; superLookup,
00034                              <span class="keyword">const</span> <a class="code" href="structUPTree.html">UPTree&lt;T&gt;</a>&amp; refTree, 
00035                              <span class="keyword">const</span> std::vector&lt;std::string&gt;&amp; refLookup,
00036                              std::string&amp; otree)
00037 {
00038   <a class="code" href="classExtractSubtree.html#p1">_ftable</a>.<a class="code" href="classFlagTable.html#a3">resize</a>(superTree.size());
00039   <a class="code" href="classExtractSubtree.html#p0">_btable</a>.<a class="code" href="classBracketTable.html#a3">resize</a>(superTree.size());
00040   <a class="code" href="classExtractSubtree.html#p0">_btable</a>.<a class="code" href="classBracketTable.html#a5">loadTree</a>(superTree);
00041   <a class="code" href="classExtractSubtree.html#p1">_ftable</a>.<a class="code" href="classFlagTable.html#a5">loadTree</a>(superTree, <a class="code" href="classExtractSubtree.html#p0">_btable</a>);
00042   <a class="code" href="classExtractSubtree.html#p2">_set</a>.clear();
00043 
00044   <span class="keywordtype">int</span> fcount = 0;
00045   <span class="keywordtype">int</span> i;
00046   <span class="keywordflow">for</span> (i = 0; i &lt; static_cast&lt;int&gt;(refLookup.size()); ++i)
00047   {
00048     <a class="code" href="classExtractSubtree.html#p2">_set</a>.insert(refLookup[i]);
00049   }
00050   
00051   <span class="keywordflow">for</span> (i = 0; i &lt; superTree.size(); ++i)
00052   {
00053     <span class="keywordflow">if</span> (superTree[i].myType() == <a class="code" href="treetok_8h.html#a4a2">LEAF</a>)
00054     {
00055       std::stringstream ss;
00056       ss &lt;&lt; superLookup[superTree[i].myLabel()];
00057       <span class="keywordflow">if</span> (<a class="code" href="classExtractSubtree.html#p2">_set</a>.find(ss.str()) == <a class="code" href="classExtractSubtree.html#p2">_set</a>.end())
00058       {
00059         assert(superTree._man-&gt;numLeaves() - fcount &gt; 3);
00060         <a class="code" href="classExtractSubtree.html#p1">_ftable</a>.<a class="code" href="classFlagTable.html#a10">flagLeaf</a>(i);
00061         ++fcount;
00062       }
00063     }
00064   }
00065   
00066   <span class="keywordflow">for</span> (i = 0; i &lt; superTree.size(); ++i)
00067   {
00068     <span class="keywordflow">if</span> (<a class="code" href="classExtractSubtree.html#p1">_ftable</a>.<a class="code" href="classFlagTable.html#a15">isDel</a>(i) == <span class="keyword">false</span>)
00069     {
00070       <span class="keywordflow">if</span> (i &gt; 0 &amp;&amp; otree[otree.length() - 1] != <span class="charliteral">'('</span> &amp;&amp; 
00071           superTree[i].myType() != <a class="code" href="treetok_8h.html#a4a1">RB</a>)
00072         otree +=  <span class="charliteral">','</span>;
00073       std::stringstream ss;
00074       <span class="keywordflow">if</span> (superTree[i].myType() == <a class="code" href="treetok_8h.html#a4a2">LEAF</a>)
00075         ss &lt;&lt; superLookup[superTree[i].myLabel()];
00076       <span class="keywordflow">else</span>
00077         ss &lt;&lt; superTree[i];
00078       otree += ss.str();
00079     }
00080   }
00081 
00082   <span class="keywordflow">return</span> superTree._man-&gt;numLeaves() - fcount == refTree._man-&gt;numLeaves();
00083 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Mon Oct 2 18:43:18 2006 for SPR by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.1 </small></address>
</body>
</html>
