<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>SPR: uptree_impl.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<div class="nav">
<a class="el" href="dir_000000.html">src</a></div>
<h1>uptree_impl.h</h1><a href="uptree__impl_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="preprocessor">#ifndef _UPTREE_IMPL_H</span>
00002 <span class="preprocessor"></span><span class="preprocessor">#define _UPTREE_IMPL_H</span>
00003 <span class="preprocessor"></span>
00004 <span class="preprocessor">#include &lt;cassert&gt;</span>
00005 <span class="preprocessor">#include "<a class="code" href="treetok_8h.html">treetok.h</a>"</span>
00006 <span class="preprocessor">#include "<a class="code" href="treemanager_8h.html">treemanager.h</a>"</span>
00007 
00012 <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
<a name="l00013"></a><a class="code" href="structUPTree.html#a0">00013</a> <span class="keyword">inline</span> <a class="code" href="structTreeTok.html">TreeTok&lt;T&gt;</a>&amp; <a class="code" href="structUPTree.html#a0">UPTree&lt;T&gt;::operator[]</a>(<span class="keywordtype">int</span> pos) 
00014 {
00015   assert(<a class="code" href="structUPTree.html#o1">_man</a>);
00016   <span class="comment">// DEBUG</span>
00017   <span class="keywordflow">if</span> (pos &gt;= <a class="code" href="structUPTree.html#a4">size</a>())
00018   {
00019     assert(pos &lt; <a class="code" href="structUPTree.html#a4">size</a>());
00020   }
00021   <span class="keywordflow">return</span> <a class="code" href="structUPTree.html#o1">_man</a>-&gt;operator[](<a class="code" href="structUPTree.html#o0">_os</a> + pos);
00022 }
00023 
00028 <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
<a name="l00029"></a><a class="code" href="structUPTree.html#a1">00029</a> <span class="keyword">inline</span> <a class="code" href="structTreeTok.html">TreeTok&lt;T&gt;</a> <a class="code" href="structUPTree.html#a0">UPTree&lt;T&gt;::operator[]</a>(<span class="keywordtype">int</span> pos)<span class="keyword"> const</span>
00030 <span class="keyword"></span>{
00031   assert(<a class="code" href="structUPTree.html#o1">_man</a>);
00032   <span class="comment">// DEBUG</span>
00033   <span class="keywordflow">if</span> (pos &gt;= <a class="code" href="structUPTree.html#a4">size</a>())
00034     assert(pos &lt; <a class="code" href="structUPTree.html#a4">size</a>());
00035   <span class="keywordflow">return</span> <a class="code" href="structUPTree.html#o1">_man</a>-&gt;operator[](<a class="code" href="structUPTree.html#o0">_os</a> + pos);
00036 }
00037 
00042 <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
<a name="l00043"></a><a class="code" href="structUPTree.html#a2">00043</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structUPTree.html#a2">UPTree&lt;T&gt;::duplicate</a>(<span class="keyword">const</span> <a class="code" href="structUPTree.html">UPTree&lt;T&gt;</a>&amp; tree)
00044 {
00045   assert(<a class="code" href="structUPTree.html#o1">_man</a> == tree._man);
00046   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; tree.size(); ++i)
00047     this-&gt;<a class="code" href="structUPTree.html#a0">operator[]</a>(i) = tree[i];
00048 }
00049 
00053 <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
<a name="l00054"></a><a class="code" href="structUPTree.html#a3">00054</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structUPTree.html#a3">UPTree&lt;T&gt;::stripFlags</a>()
00055 {
00056   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="structUPTree.html#a4">size</a>(); ++i)
00057     this-&gt;<a class="code" href="structUPTree.html#a0">operator[]</a>(i).setFlag(<span class="keyword">false</span>);
00058 }
00059 
00066 <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
<a name="l00067"></a><a class="code" href="structUPTree.html#a4">00067</a> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="structUPTree.html#a4">UPTree&lt;T&gt;::size</a>()<span class="keyword"> const</span>
00068 <span class="keyword"></span>{
00069   assert(<a class="code" href="structUPTree.html#o1">_man</a>);
00070   <span class="keywordflow">return</span> <a class="code" href="structUPTree.html#o1">_man</a>-&gt;treeSize();
00071 }
00072 
00078 <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
<a name="l00079"></a><a class="code" href="structUPTree.html#a5">00079</a> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="structUPTree.html#a5">UPTree&lt;T&gt;::getPos</a>(T label)<span class="keyword"> const</span>
00080 <span class="keyword"></span>{
00081   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; <a class="code" href="structUPTree.html#a4">size</a>(); ++i)
00082     <span class="keywordflow">if</span> (this-&gt;operator[](i).myType() == <a class="code" href="treetok_8h.html#a4a2">LEAF</a> &amp;&amp;
00083         this-&gt;<a class="code" href="structUPTree.html#a0">operator[]</a>(i).myLabel() == label)
00084       <span class="keywordflow">return</span> i;
00085   <span class="keywordflow">return</span> -1;
00086 }
00087 
00091 <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
<a name="l00092"></a><a class="code" href="uptree__impl_8h.html#a0">00092</a> std::ostream&amp; operator&lt;&lt;(std::ostream&amp; os , const UPTree&lt;T&gt;&amp; tree)
00093 {
00094   <span class="keywordtype">int</span> p = 0;
00095   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; tree.size(); ++i)
00096   {
00097     <span class="keywordflow">if</span> (tree[i].myFlag() == <span class="keyword">false</span>)
00098     {
00099       <span class="keywordflow">if</span> (i &gt; 0 &amp;&amp; tree[p].myType() != <a class="code" href="treetok_8h.html#a4a0">LB</a> &amp;&amp; tree[i].myType() != <a class="code" href="treetok_8h.html#a4a1">RB</a>)
00100         os &lt;&lt; <span class="charliteral">','</span>;
00101       os &lt;&lt; tree[i];
00102       p = i;
00103     }
00104   }
00105   <span class="keywordflow">return</span> os;
00106 }
00107 
00112 <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
<a name="l00113"></a><a class="code" href="uptree__impl_8h.html#a1">00113</a> std::istream&amp; <a class="code" href="uptree_8h.html#a1">operator&gt;&gt;</a>(std::istream&amp; is , <a class="code" href="structUPTree.html">UPTree&lt;T&gt;</a>&amp; tree)
00114 {
00115   <span class="keywordtype">char</span>* buf = (<span class="keywordtype">char</span>*)malloc((tree.size() * 5) * <span class="keyword">sizeof</span>(char));
00116   <span class="keywordtype">char</span> nbuf[8];
00117   is &gt;&gt; buf;
00118   <span class="keywordtype">int</span> n = strlen(buf);
00119   <span class="keywordtype">int</span> rsize = 0;
00120   <span class="keywordtype">int</span> p;
00121   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; ++i)
00122   {
00123     assert(rsize &lt; tree.size());
00124 
00125     <span class="keywordflow">if</span> (buf[i] == <span class="charliteral">'('</span>)
00126       tree[rsize].setLB();
00127     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (buf[i] == <span class="charliteral">')'</span>)
00128       tree[rsize].setRB();
00129     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (buf[i] == <span class="charliteral">','</span>)
00130       --rsize;
00131     <span class="keywordflow">else</span>
00132     {
00133       p = strcspn(buf + i, <span class="stringliteral">"(),"</span>);
00134       assert(p &gt; 0);
00135       strncpy(nbuf, buf + i, p);
00136       nbuf[p] = <span class="charliteral">'\0'</span>;
00137       tree[rsize].setLeaf(atoi(nbuf));
00138       i += p - 1;
00139     }
00140     ++rsize;
00141   }
00142   assert(rsize &lt;= tree.size());
00143   free(buf);
00144   <span class="keywordflow">return</span> is;
00145 }
00146 
00147 <span class="preprocessor">#endif</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Mon Oct 2 18:43:18 2006 for SPR by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.1 </small></address>
</body>
</html>
